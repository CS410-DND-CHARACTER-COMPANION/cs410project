<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D&D Character Sheet V3.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Uncial+Antiqua&family=Roboto+Slab:wght@300;700&display=swap" rel="stylesheet">
    <!-- Create separate CSS style sheet to keep code clean -->
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <h1>D&D Character Sheet V3.0</h1>

        <form id = "characterForm">
            <section class="character-info">
                <h2>Character Information</h2>
                <label for="name">Name:</label>
                <input type="text" id="name" placeholder="Enter character name" required>
                
                <label for="background">Background:</label>
                <input type="text" id="background" placeholder="Enter character background">
                
                <label for="species">Species:</label>
                <select id="species" class="custom-select" required>
                    <option value="">Select species</option>
                    <option value="Human">Human</option>
                    <option value="Elf">Elf</option>
                    <option value="Dwarf">Dwarf</option>
                    <option value="Halfling">Halfling</option>
                    <option value="Dragonborn">Dragonborn</option>
                    <option value="Tiefling">Tiefling</option>
                    <option value="Gnome">Gnome</option>
                    <option value="Half-Elf">Half-Elf</option>
                    <option value="Half-Orc">Half-Orc</option>
                    <option value="Orc">Orc</option>
                    <option value="Aasimar">Aasimar</option>
                    <option value="Genasi">Genasi</option>
                    <option value="Firbolg">Firbolg</option>
                    <option value="Goliath">Goliath</option>
                    <option value="Tabaxi">Tabaxi</option>
                    <option value="Triton">Triton</option>
                    <option value="Yuan-ti Pureblood">Yuan-ti Pureblood</option>
                    <option value="Kenku">Kenku</option>
                    <option value="Changeling">Changeling</option>
                    <option value="Warforged">Warforged</option>
                    <option value="Hobgoblin">Hobgoblin</option>
                    <option value="Bugbear">Bugbear</option>
                    <option value="Goblin">Goblin</option>
                    <option value="Kobold">Kobold</option>
                    <option value="Revenant">Revenant</option>
                    <option value="Fey'ri">Fey'ri</option>
                    <option value="Merfolk">Merfolk</option>
                    <option value="Sahuagin">Sahuagin</option>
                    <option value="Aarakocra">Aarakocra</option>
                    <option value="Lizardfolk">Lizardfolk</option>
                </select>
                
                <label for="class">Class:</label>
                <input type="text" id="class" placeholder="Enter character class" required>
                
                <label for="subclass">Subclass:</label>
                <input type="text" id="subclass" placeholder="Enter character subclass">
                
                <label for="level">Level:</label>
                <input type="number" id="level" placeholder="Enter character level" min="1" max="20" value="1">
                
                <label for="xp">Experience Points (XP):</label>
                <input type="number" id="xp" placeholder="Enter character XP" min="0" value="0">
            </section>

            <section class="combat-details">
                <h2>Combat Details</h2>
                <label for="ac">Armor Class (AC):</label>
                <input type="number" id="ac" placeholder="Enter AC" min="0" value="10">
                
                <label for="shield">Shield Bonus:</label>
                <input type="number" id="shield" placeholder="Enter shield bonus">
                
                <label for="currentHP">Current HP:</label>
                <input type="number" id="currentHP" placeholder="Enter current HP" min="0" required>
                
                <label for="maxHP">Maximum HP:</label>
                <input type="number" id="maxHP" placeholder="Enter max HP" min="1" required>
                
                <label for="inspiration">Heroic Inspiration:</label>
                <input type="checkbox" id="inspiration">
            </section>

            <section class="reference-details">
                <h2>Reference Details</h2>
                <label for="initiative">Initiative:</label>
                <input type="number" id="initiative" placeholder="Enter initiative" value="0">
                
                <label for="speed">Speed:</label>
                <input type="number" id="speed" placeholder="Enter speed" min="0" value="30">
            </section>

            <!-- Had to comment out for now, will need to reintegrate
            <section class="inventory">
                <h2>Inventory</h2>
                <label for="inventory-item">New Item:</label>
                <input type="text" id="inventory-item" placeholder="Enter item name">
                <button class="add-item-btn" onclick="addInventoryItem()">Add Item</button>

                <div id="inventory"></div>
            </section>
            -->

            <button type="submit" class="save-btn">Create Character</button>
            <button id="characterInfo" class="save-btn">Show Character Info</button>
        </form>
    </div>

    <!-- List to display characters -->
    <div class ="container">
        <section class="character-List">
            <h2>Current Characters</h2>
            <ul id="characterList">
                <!-- Characters will be dynamically added here -->
            </ul>
        </section>
    </div>
    
    <!-- socket.io integration -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/socket.js"></script>

    <script>
        document.getElementById('characterInfo').addEventListener('click', function() {
            window.location.href = 'displayCharacter.html';
            //replcae if url if found a way to host online instead of local host
        });
    </script>

    <!-- Had to comment out to get the socket connection to work
    <script>
        let inventory = [];

        window.onload = function() {
            const savedCharacter = localStorage.getItem('dndCharacter');
            if (savedCharacter) {
                const characterData = JSON.parse(savedCharacter);
                loadCharacterData(characterData);
            }
        };

        function loadCharacterData(data) {
            document.getElementById('name').value = data.name || '';
            document.getElementById('background').value = data.background || '';
            document.getElementById('species').value = data.species || '';
            document.getElementById('class').value = data.class || '';
            document.getElementById('subclass').value = data.subclass || '';
            document.getElementById('level').value = data.level || '';
            document.getElementById('xp').value = data.xp || '';
            document.getElementById('ac').value = data.ac || '';
            document.getElementById('shield').value = data.shield || '';
            document.getElementById('current-hp').value = data.currentHp || '';
            document.getElementById('max-hp').value = data.maxHp || '';
            document.getElementById('inspiration').checked = data.inspiration || false;
            document.getElementById('initiative').value = data.initiative || '';
            document.getElementById('speed').value = data.speed || '';
            inventory = data.inventory || [];
            renderInventory();
        }

        function renderInventory() {
            const inventoryContainer = document.getElementById('inventory');
            inventoryContainer.innerHTML = '';
            inventory.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'inventory-item';
                itemElement.innerHTML = `
                    <span>${item}</span>
                    <button class="delete-item-btn" onclick="deleteInventoryItem(${index})">Delete</button>
                `;
                inventoryContainer.appendChild(itemElement);
            });
        }

        function addInventoryItem() {
            const itemInput = document.getElementById('inventory-item');
            const itemName = itemInput.value.trim();
            if (itemName) {
                inventory.push(itemName);
                itemInput.value = '';
                renderInventory();
            }
        }

        function deleteInventoryItem(index) {
            inventory.splice(index, 1);
            renderInventory();
        }

        function saveCharacter() {
            const characterData = {
                name: document.getElementById('name').value,
                background: document.getElementById('background').value,
                species: document.getElementById('species').value,
                class: document.getElementById('class').value,
                subclass: document.getElementById('subclass').value,
                level: document.getElementById('level').value,
                xp: document.getElementById('xp').value,
                ac: document.getElementById('ac').value,
                shield: document.getElementById('shield').value,
                currentHP: document.getElementById('currentHP').value,
                maxHP: document.getElementById('maxHP').value,
                inspiration: document.getElementById('inspiration').checked,
                initiative: document.getElementById('initiative').value,
                speed: document.getElementById('speed').value,
                inventory: inventory
            };
            localStorage.setItem('dndCharacter', JSON.stringify(characterData));
            alert('Character saved successfully!');
        }

        document.getElementById('inventory-item').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addInventoryItem();
            }
        });

        document.getElementById("characterInfo").onclick = function(){
            location.href = "https://cs.umb.edu/cs410/longprojects/3-Zac/cs410project/frontend/displayCharacter.html"; 
            //change to a different url if needed
        };

    </script>
    -->
</body>
</html>